(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bfebda5c"],{"34de":function(e,t,n){"use strict";var a=n("c9eb"),r=n.n(a);r.a},"88e6":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"table-wrapper"},[n("a-card",[n("div",{staticClass:"flex flex-wrap",staticStyle:{display:"none"},attrs:{slot:"title"},slot:"title"},[n("div",{staticClass:"filter-wrapper",staticStyle:{margin:"0 15px"}},[n("span",{staticClass:"label"},[e._v("The type of competition：")]),n("a-tree-select",{staticStyle:{width:"100%"},attrs:{"dropdown-style":{maxHeight:"400px",overflow:"auto"},"tree-data":e.treeData,placeholder:"Please select","tree-default-expand-all":""},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)]),n("standard-table",{attrs:{tableData:e.tableData,tableHead:e.tableHead,loading:e.loading,pagination:{pageSize:e.filterList.size,current:e.filterList.page,total:e.filterList.total,showTotal:function(t){return e.filterList.total+" 条"}}},on:{changeCurrent:e.handleChangeCurrent},scopedSlots:e._u([{key:"index",fn:function(t){var a=t.index;return n("div",{},[e._v(" "+e._s(a+1)+" ")])}},{key:"is_auto_pass",fn:function(t){var a=t.text,r=t.record;return n("div",{},[n("a-switch",{attrs:{checked:"1"==a,disabled:""},on:{change:function(t){return e.changeStatus(r,"is_auto_pass",t)}}})],1)}},{key:"contract_is_show",fn:function(t){var a=t.text,r=t.record;return n("div",{},[n("a-switch",{attrs:{checked:"1"==a},on:{change:function(t){return e.changeStatus(r,"contract_is_show",t)}}})],1)}},{key:"end_time",fn:function(t){var a=t.text;return n("div",{},[e._v(e._s(e.timestampToTime(a,!0)))])}},{key:"pass_lock",fn:function(t){var a=t.text,r=t.record;return n("div",{},[n("a-switch",{attrs:{checked:"1"==a},on:{change:function(t){return e.changeStatus(r,"pass_lock",t)}}})],1)}},{key:"state",fn:function(t){var a=t.text;return n("div",{},[e._v(e._s(e.gameState[a]))])}},{key:"action",fn:function(t){var a=t.text,r=t.record;return n("div",{},[n("a-button",{attrs:{type:"primary",size:"small",disabled:3!=r.state},on:{click:function(t){return e.handleEdit(r,a)}}},[e._v(" 结算 ")]),n("a-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"small",disabled:!(1==r.state)},on:{click:function(t){return e.handleAudit(r,a)}}},[e._v(" 审核 ")])],1)}}])})],1),n("a-modal",{attrs:{title:"edit",visible:e.editShow,okText:"ok",cancelText:"cancel",width:620},on:{ok:e.handleConfirm,cancel:function(t){e.editShow=!1}}},[n("a-form-model",{attrs:{hideRequiredMark:""}},e._l(e.activeList.detail,(function(t,a){return n("div",[n("h3",[e._v(e._s(t.game_type))]),n("a-table",{attrs:{scroll:{y:300},pagination:!1,columns:e.columns,"data-source":t.detail},scopedSlots:e._u([{key:"modulo",fn:function(t,r,i){return n("span",{},[n("a-checkbox",{on:{change:function(n){return e.changeWin(r,t,a,i)}}})],1)}}],null,!0)})],1)})),0)],1),n("a-modal",{attrs:{title:"警告"},on:{ok:e.handleOk},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[n("h2",[e._v("请确认选择的选项，一旦结算无法更改!")]),e._l(e.confirm,(function(t){return n("h3",{staticStyle:{color:"#f00"}},[e._v(e._s(t))])}))],2)],1)},r=[],i=(n("a15b"),n("d81d"),n("b0c0"),n("3835")),c=(n("96cf"),n("1da1")),s=n("a078"),o=n("89cb"),u=n("a567"),l=n("ad8f"),d=(n("ed08"),[{title:"投注名",align:"center",dataIndex:"bet_name",key:"bet_name"},{title:"倍率",align:"center",dataIndex:"odds",key:"odds"},{title:"赢家",align:"center",dataIndex:"modulo",key:"modulo",scopedSlots:{customRender:"modulo"}}]),f={name:"game",components:{standardTable:u["a"]},data:function(){return{visible:!1,count:5,columns:d,value:"newsType",gameState:["可开始","审核中","游戏中","待结算"],currentAccount:"",activeList:{detail:[],game:null},confirm:[],treeData:[{title:"newsType",value:"newsType",key:"1",children:[{title:"football",value:"football",key:"2",children:[{title:"football1",value:"football1",key:"3"},{title:"football12",value:"football12",key:"4"}]},{title:"game",value:"game",key:"5",children:[{key:"6",title:"lol",value:"lol"}]}]}],typeOption:[{key:"football",label:"football"},{key:"game",label:"game"}],tableHead:[{title:"标题",align:"center",dataIndex:"title.subtitle",ellipsis:!0},{title:"游戏名",align:"center",dataIndex:"game_name"},{title:"结束时间",align:"center",dataIndex:"end_time",scopedSlots:{customRender:"end_time"}},{title:"状态",align:"center",dataIndex:"state",scopedSlots:{customRender:"state"}},{title:"操作",align:"center",scopedSlots:{customRender:"action"},width:140}],tableData:[],loading:!1,selectedRowKeys:[],selectValue:[],currentEdit:{},editShow:!1,filterList:{name:"",status:"",page:1,size:15,total:0},deleteLoading:!1,exportLoading:!1}},mounted:function(){this.getAccounts(),this.getGameList({page:1,size:15})},methods:{getAccounts:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,s["b"].eth.getAccounts();case 2:n=t.sent,a=Object(i["a"])(n,1),r=a[0],e.currentAccount=r;case 7:case"end":return t.stop()}}),t)})))()},getGameList:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.loading=!0,n.prev=1,n.next=4,Object(o["h"])(e);case 4:a=n.sent,t.tableData=a.data.record,t.filterList.total=a.data.total||0,t.loading=!1,n.next=16;break;case 11:n.prev=11,n.t0=n["catch"](1),t.$message.error("系统繁忙"),t.loading=!1;case 16:case"end":return n.stop()}}),n,null,[[1,11]])})))()},getContractList:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Object(o["h"])(e);case 3:n.sent,n.next=11;break;case 7:n.prev=7,n.t0=n["catch"](0),t.$message.error("系统繁忙");case 11:case"end":return n.stop()}}),n,null,[[0,7]])})))()},settlementList:function(e,t,n){var a=this;return Object(c["a"])(regeneratorRuntime.mark((function r(){var i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=2,a.activeList={detail:[],game:null},r.next=6,Object(o["l"])({contract_address:e,game_id:t});case 6:i=r.sent,a.activeList.detail=i.data,a.activeList.game=e,a.activeList.title=n,a.editShow=!0,r.next=17;break;case 13:r.prev=13,r.t0=r["catch"](2),a.$message.error("系统繁忙");case 17:case"end":return r.stop()}}),r,null,[[2,13]])})))()},auditPass:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=1,n.next=4,Object(s["a"])(e);case 4:return a=n.sent,n.next=7,a.methods.pass(2e7,20000001).send({from:t.currentAccount,gas:"5000000"});case 7:r=n.sent,r.status&&(t.$message.error("结算成功"),t.getGameList({page:1,size:15})),n.next=14;break;case 11:n.prev=11,n.t0=n["catch"](1);case 14:case"end":return n.stop()}}),n,null,[[1,11]])})))()},timestampToTime:function(e,t){var n=new Date(1e3*e),a=n.getFullYear()+"-",r=(n.getMonth()+1<10?"0"+(n.getMonth()+1):n.getMonth()+1)+"-",i=(n.getDate()<10?"0"+n.getDate():n.getDate())+" ",c=(n.getHours()<10?"0"+n.getHours():n.getHours())+":",s=(n.getMinutes()<10?"0"+n.getMinutes():n.getMinutes())+":",o=n.getSeconds()<10?"0"+n.getSeconds():n.getSeconds();return t?a+r+i+c+s+o:a+r+i},handleSelect:function(e,t){this.selectedRowKeys=e,this.selectValue=t},createArray:function(e){for(var t=[],n=0;n<e;n++)t[n]=!1;return t},getMaxModulo:function(e){return Object(c["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(s["a"])(e);case 2:return n=t.sent,t.next=6,n.methods.maxModulo().call();case 6:return a=t.sent,t.abrupt("return",a);case 8:case"end":return t.stop()}}),t)})))()},getFromData:function(){},getTableData:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n,a,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.filterList,n.name,n.status,a=n.page,r=n.size,e.loading=!0,t.prev=2,t.next=5,Object(o["h"])({page:a,size:r});case 5:i=t.sent,e.tableData=i.data.record,e.filterList.total=i.data.total||0,e.loading=!1,t.next=17;break;case 12:t.prev=12,t.t0=t["catch"](2),e.$message.error("系统繁忙"),e.loading=!1;case 17:case"end":return t.stop()}}),t,null,[[2,12]])})))()},changeStatus:function(e,t,n){var a=this;return Object(c["a"])(regeneratorRuntime.mark((function r(){var i,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return i={contract_address:e.contract_address},i[t+""]=n?1:0,r.prev=4,r.next=7,Object(o["m"])(i);case 7:c=r.sent,200==c.code&&(a.$message.success(c.message),e[t]=n),r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](4),a.$message.error("系统繁忙");case 15:case"end":return r.stop()}}),r,null,[[4,11]])})))()},changeWin:function(e,t,n,a){1==e["check"]?e["check"]=0:e["check"]=1},handleChangeCurrent:function(e){this.filterList.page=e,this.getTableData()},search:function(){this.filterList.page=1,this.getTableData()},handleEdit:function(e,t){var n=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var a,r,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n.getAccounts(),t.next=3,s["b"].eth.getAccounts();case 3:if(a=t.sent,r=Object(i["a"])(a,1),c=r[0],n.currentAccount=c,n.currentAccount){t.next=10;break}return n.$message.error("请先登录MetaMask"),t.abrupt("return");case 10:n.settlementList(e.contract_address,e.game_id,e.title);case 12:case"end":return t.stop()}}),t)})))()},handleAudit:function(e,t){var n=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var a,r,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,s["b"].eth.getAccounts();case 2:if(a=t.sent,r=Object(i["a"])(a,1),c=r[0],n.currentAccount=c,n.currentAccount){t.next=9;break}return n.$message.error("请先登录MetaMask"),t.abrupt("return");case 9:n.auditPass(e.contract_address);case 11:case"end":return t.stop()}}),t)})))()},handleDelete:function(e){var t=this,n=e.id;Object(l["b"])({id:n}).then((function(e){t.getTableData(),t.$message.success("删除成功")}))},batchDeleteTable:function(){var e=this;if(0!=this.selectValue.length){this.deleteLoading=!0;var t=this.selectValue.map((function(e){return e.id})).join(",");Object(l["a"])({batchId:t}).then((function(t){e.getTableData(),e.$message.success("批量删除成功"),e.deleteLoading=!1}))}else this.$message.warning("请至少勾选一项")},handleOk:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n,a,r,i,c,o,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=1,t.next=4,Object(s["a"])(e.activeList.game);case 4:return n=t.sent,t.next=7,n.methods.maxModulo().call();case 7:for(a=t.sent,r=e.createArray(a),i=e.activeList.detail,c=0;c<i.length;c++)for(o=0;o<i[c].detail.length;o++)1==i[c].detail[o].check&&(r[+i[c].detail[o].modulo-1]=!0);return t.next=15,n.methods.settleRound(r).send({from:e.currentAccount,gas:"5000000"});case 15:u=t.sent,u.status&&(e.$message.error("结算成功"),e.getGameList({page:1,size:15})),e.visible=!1,t.next=25;break;case 20:t.prev=20,t.t0=t["catch"](1),e.$message.error("结算失败"),e.visible=!1;case 25:case"end":return t.stop()}}),t,null,[[1,20]])})))()},handleConfirm:function(){var e=this.activeList.detail,t=!0;this.confirm=[];for(var n=0;n<e.length;n++)for(var a=0;a<e[n].detail.length;a++)1==e[n].detail[a].check&&(t=!1,this.confirm.push(e[n].detail[a].bet_name));t?this.$message.error("必须至少选择一项"):this.visible=!0}}},g=f,p=(n("34de"),n("2877")),h=Object(p["a"])(g,a,r,!1,null,"33f346f2",null);t["default"]=h.exports},"89cb":function(e,t,n){"use strict";n.d(t,"j",(function(){return i})),n.d(t,"k",(function(){return c})),n.d(t,"h",(function(){return s})),n.d(t,"l",(function(){return o})),n.d(t,"m",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"g",(function(){return g})),n.d(t,"f",(function(){return p})),n.d(t,"d",(function(){return h})),n.d(t,"i",(function(){return m})),n.d(t,"a",(function(){return b}));var a=n("b775"),r=a.request;function i(e){return r.post("/game/getGameList",e)}function c(e){return r.post("/type/getTypeList",e)}function s(e){return r.post("/contract/getContractList",e)}function o(e){return r.post("/contract/settlementList",e)}function u(e){return r.post("/contract/updateState",e)}function l(e){return r.post("/game/editGameList",e)}function d(e){return r.post("/type/addType",e)}function f(e){return r.post("/type/addTypeGame",e)}function g(e){return r.post("/type/editTypeGame",e)}function p(e){return r.post("/type/editType",e)}function h(e){return r.post("/type/deleteTypeList",e)}function m(e){return r.post("/game/getDetailModel",e)}function b(e){return r.post("/game/addGameList",e)}},a15b:function(e,t,n){"use strict";var a=n("23e7"),r=n("44ad"),i=n("fc6a"),c=n("a640"),s=[].join,o=r!=Object,u=c("join",",");a({target:"Array",proto:!0,forced:o||!u},{join:function(e){return s.call(i(this),void 0===e?",":e)}})},a567:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tableCommon-wrapper"},[n("a-table",{attrs:{columns:e.tableHead,dataSource:e.tableData,loading:e.loading,pagination:e.pagination,"row-selection":e.rowSelection,rowKey:"id",scroll:e.scroll},on:{change:e.handleTableChange},scopedSlots:e._u([e._l(Object.keys(e.$scopedSlots).filter((function(e){return"expandedRowRender"!==e})),(function(t){return{key:t,fn:function(n,a,r){return[e._t(t,null,null,{text:n,record:a,index:r})]}}}))],null,!0)})],1)},r=[],i={name:"standardTable",props:{tableHead:{type:Array,required:!0},tableData:{type:Array,required:!0},loading:{type:Boolean,default:!1},pagination:{type:Boolean|Object},rowSelection:{type:Object},scroll:{type:Object}},data:function(){return{}},methods:{handleTableChange:function(e){this.$emit("changeCurrent",e.current)}}},c=i,s=n("2877"),o=Object(s["a"])(c,a,r,!1,null,"efa95cdc",null);t["a"]=o.exports},ad8f:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c}));var a=n("b775"),r=a.request;function i(e){return r.post("/table/deleteTable",e)}function c(e){return r.post("/table/batchDeleteTable",e)}},c9eb:function(e,t,n){},ed08:function(e,t,n){"use strict";function a(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this;return function(){for(var i=arguments.length,c=new Array(i),s=0;s<i;s++)c[s]=arguments[s];if(a)return e.apply(r,c),void(a=!1);clearTimeout(n),n=setTimeout((function(){e.apply(r,c)}),t)}}n.d(t,"a",(function(){return a}))}}]);