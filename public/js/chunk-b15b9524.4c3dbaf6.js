(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b15b9524"],{4143:function(e,t,o){"use strict";o.r(t);var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"roleManage-wrapper"},[o("a-card",{attrs:{hoverable:!0,bordered:!1}},[o("div",{staticClass:"flex flex-wrap",attrs:{slot:"title"},slot:"title"}),o("standard-table",{attrs:{tableData:e.tableData.record,tableHead:e.tableHead,loading:e.loading,pagination:!1},scopedSlots:e._u([{key:"index",fn:function(t){var n=t.index;return o("div",{},[e._v(" "+e._s(n+1)+" ")])}},{key:"action",fn:function(t){var n=t.text;return o("div",{},[o("a-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleEdit(n)}}},[e._v(" 编辑 ")]),o("a-popconfirm",{attrs:{title:"你确定要删除当前列吗?","ok-text":"是","cancel-text":"否",disabled:n.role&&"admin"==n.role},on:{confirm:function(t){return e.handleDelete(n)}}},[o("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"danger",size:"small",disabled:n.role&&"admin"==n.role}},[e._v(" 删除 ")])],1)],1)}}])})],1),e.dialogVisible?o("role-model",{attrs:{currentRow:e.currentRow,dialogVisible:e.dialogVisible,tableData:e.tableData.record},on:{ok:e.handleOk,cancel:function(t){e.dialogVisible=!1}}}):e._e()],1)},r=[],a=o("5530"),l=o("53ca"),i=o("a567"),c=o("b775"),s=c.request,u=c.request2;function d(e){return s.post("/roleManage/roleTableData",e)}function f(e){return s.post("/roleManage/deleteRole",e)}function h(e){return s.post("/roleManage/editRole",e)}function m(e){return console.log("request2",u),s.post("/roleManage/addRole",e)}function p(e){return s.post("/roleManage/getRoleRoute",e)}var b=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("a-modal",{attrs:{title:e.currentRow?"编辑":"新增",visible:e.dialogVisible,okText:"确认",cancelText:"取消",width:620,confirmLoading:e.loading},on:{ok:e.handleSure,cancel:function(){e.$emit("cancel")}}},[o("a-form-model",{ref:"roleFrom",attrs:{model:e.roleFrom,rules:e.roleRule,"label-col":{span:4},"wrapper-col":{span:16},hideRequiredMark:""}},[o("a-form-model-item",{directives:[{name:"show",rawName:"v-show",value:e.currentRow,expression:"currentRow"}],attrs:{prop:"id",label:"id"}},[o("a-input",{attrs:{disabled:""},model:{value:e.roleFrom.id,callback:function(t){e.$set(e.roleFrom,"id",t)},expression:"roleFrom.id"}})],1),o("a-form-model-item",{attrs:{prop:"role",label:"角色名称"}},[o("a-input",{model:{value:e.roleFrom.role,callback:function(t){e.$set(e.roleFrom,"role",t)},expression:"roleFrom.role"}})],1),o("a-form-model-item",{attrs:{prop:"text",label:"描述"}},[o("a-textarea",{attrs:{placeholder:"描述...",autoSize:{minRows:3,maxRows:5}},model:{value:e.roleFrom.text,callback:function(t){e.$set(e.roleFrom,"text",t)},expression:"roleFrom.text"}})],1),e._v(" "+e._s(e.roleFrom.menu)+" ")],1)],1)},g=[],R=(o("c975"),o("d81d"),o("498a"),function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("a-tree",{attrs:{checkable:"","tree-data":e.treeData,checkedKeys:e.checkKeyList},on:{check:e.handleSelect}})}),y=[],v=(o("99af"),o("4de4"),o("4160"),o("159b"),o("5880")),w=o("a18c"),x={name:"standardTree",model:{prop:"checkKeyList",event:"change-checkKeyList"},props:{role:String,checkKeyList:{type:Array,default:[]}},data:function(){return{treeData:[]}},computed:Object(a["a"])(Object(a["a"])({},Object(v["mapGetters"])(["baseRoute"])),{},{asyncRoutes:function(){return w["a"]}}),created:function(){var e=this.filtrRoute(this.asyncRoutes);this.treeData=this.generateRoutes(e),this.gerRoleRoute()},methods:{gerRoleRoute:function(){var e=this;console.log("this.role",this.role),this.role&&p(this.role).then((function(t){var o=t.data||[];console.log("data",o),e.checkKeyList=o}))},filtrRoute:function(e){return 0==e.length?[]:e.filter((function(e){return e.children}))[0].children},generateRoutes:function(e){var t=this,o=[];return e.forEach((function(e){var n={key:e.path,title:e.meta.title};e.children&&(n.children=t.generateRoutes(e.children)),o.push(n)})),o},getSelectRoute:function(e){var t=this,o=[];return e.forEach((function(e){e.children?o=o.concat(t.getSelectRoute(e.children)):o.push(e.path)})),o},handleSelect:function(e){this.checkKeyList=e,this.$emit("change-checkKeyList",this.checkKeyList)}},watch:{role:function(e,t){this.gerRoleRoute()}}},k=x,S=o("2877"),F=Object(S["a"])(k,R,y,!1,null,"7d36206c",null),_=F.exports,O={name:"roleModel",props:{currentRow:[Object,null],dialogVisible:Boolean,tableData:Array},components:{standardTree:_},data:function(){var e=this,t=function(t,o,n){e.currentRow&&n(),0===o.trim().length?n(new Error("角色名称不能为空！")):-1!=e.roleList.indexOf(o)?n(new Error("已存在相同角色名称！")):n()};return{roleRule:{role:[{required:!0,trigger:"blur",validator:t}],text:[{required:!0,trigger:"blur",min:5,message:"请至少输入五个字符描述！"}]},roleFrom:{role:"",menu:[]},loading:!1}},computed:{roleList:function(){return this.tableData.map((function(e){return e.role}))}},mounted:function(){this.roleFrom=Object(a["a"])({},this.currentRow)||{role:""}},methods:{handleSure:function(){var e=this;this.$refs.roleFrom.validate((function(t){e.loading=!0,t?e.currentRow?h(e.roleFrom).then((function(){e.$message.success("修改成功!"),e.loading=!1,e.$emit("ok")})):(console.log("this.roleFrom",e.roleFrom),m(e.roleFrom).then((function(){e.$message.success("添加成功!"),e.loading=!1,e.$emit("ok")}))):e.loading=!1}))}}},D=O,$=Object(S["a"])(D,b,g,!1,null,null,null),j=$.exports,T=[{title:"序号",dataIndex:"index",scopedSlots:{customRender:"index"},width:60},{title:"id",dataIndex:"id",ellipsis:!0},{title:"权限",dataIndex:"role",ellipsis:!0},{title:"描述",dataIndex:"text",ellipsis:!0},{title:"操作",scopedSlots:{customRender:"action"},width:140}],L={name:"roleManage",components:{standardTable:i["a"],roleModel:j},data:function(){return{loading:!1,tableData:[],currentRow:null,dialogVisible:!1,tableHead:T}},created:function(){this.getRoleTable()},methods:{handleAdd:function(){this.currentRow=null,this.dialogVisible=!0},getRoleTable:function(){var e=this;d().then((function(t){console.log("tableData",Object(l["a"])(t.data)),e.tableData=t.data||[]}))},handleEdit:function(e){this.currentRow=Object(a["a"])({},e),this.dialogVisible=!0},handleOk:function(){this.dialogVisible=!1,this.currentRow=null,this.getRoleTable()},handleDelete:function(e){var t=this;f({id:e.id}).then((function(){t.$message.success("删除成功!"),t.getRoleTable()}))}}},E=L,K=Object(S["a"])(E,n,r,!1,null,"0132645a",null);t["default"]=K.exports},"498a":function(e,t,o){"use strict";var n=o("23e7"),r=o("58a8").trim,a=o("c8d2");n({target:"String",proto:!0,forced:a("trim")},{trim:function(){return r(this)}})},"53ca":function(e,t,o){"use strict";o.d(t,"a",(function(){return n}));o("a4d3"),o("e01a"),o("d28b"),o("d3b7"),o("3ca3"),o("ddb0");function n(e){return n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}},a567:function(e,t,o){"use strict";var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"tableCommon-wrapper"},[o("a-table",{attrs:{columns:e.tableHead,dataSource:e.tableData,loading:e.loading,pagination:e.pagination,"row-selection":e.rowSelection,rowKey:"id",scroll:e.scroll},on:{change:e.handleTableChange},scopedSlots:e._u([e._l(Object.keys(e.$scopedSlots).filter((function(e){return"expandedRowRender"!==e})),(function(t){return{key:t,fn:function(o,n,r){return[e._t(t,null,null,{text:o,record:n,index:r})]}}}))],null,!0)})],1)},r=[],a={name:"standardTable",props:{tableHead:{type:Array,required:!0},tableData:{type:Array,required:!0},loading:{type:Boolean,default:!1},pagination:{type:Boolean|Object},rowSelection:{type:Object},scroll:{type:Object}},data:function(){return{}},methods:{handleTableChange:function(e){this.$emit("changeCurrent",e.current)}}},l=a,i=o("2877"),c=Object(i["a"])(l,n,r,!1,null,"efa95cdc",null);t["a"]=c.exports},c8d2:function(e,t,o){var n=o("d039"),r=o("5899"),a="​᠎";e.exports=function(e){return n((function(){return!!r[e]()||a[e]()!=a||r[e].name!==e}))}}}]);