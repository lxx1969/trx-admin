(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0d33cc81"],{"7c91":function(e,t,a){"use strict";var n=a("ebf0"),r=a.n(n);r.a},"88e6":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table-wrapper"},[a("a-card",[a("div",{staticClass:"flex flex-wrap",staticStyle:{display:"none"},attrs:{slot:"title"},slot:"title"},[a("div",{staticClass:"filter-wrapper",staticStyle:{margin:"0 15px"}},[a("span",{staticClass:"label"},[e._v("The type of competition：")]),a("a-tree-select",{staticStyle:{width:"100%"},attrs:{"dropdown-style":{maxHeight:"400px",overflow:"auto"},"tree-data":e.treeData,placeholder:"Please select","tree-default-expand-all":""},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)]),a("standard-table",{attrs:{tableData:e.tableData,tableHead:e.tableHead,loading:e.loading,pagination:{pageSize:e.filterList.size,current:e.filterList.page,total:e.filterList.total,showTotal:function(t){return e.filterList.total+" 条"}}},on:{changeCurrent:e.handleChangeCurrent},scopedSlots:e._u([{key:"index",fn:function(t){var n=t.index;return a("div",{},[e._v(" "+e._s(n+1)+" ")])}},{key:"is_auto_pass",fn:function(t){var n=t.text,r=t.record;return a("div",{},[a("a-switch",{attrs:{checked:"1"==n,disabled:""},on:{change:function(t){return e.changeStatus(r,"is_auto_pass",t)}}})],1)}},{key:"contract_is_show",fn:function(t){var n=t.text,r=t.record;return a("div",{},[a("a-switch",{attrs:{checked:"1"==n},on:{change:function(t){return e.changeStatus(r,"contract_is_show",t)}}})],1)}},{key:"end_time",fn:function(t){var n=t.text;return a("div",{},[e._v(e._s(e.timestampToTime(n,!0)))])}},{key:"pass_lock",fn:function(t){var n=t.text,r=t.record;return a("div",{},[a("a-switch",{attrs:{checked:"1"==n},on:{change:function(t){return e.changeStatus(r,"pass_lock",t)}}})],1)}},{key:"state",fn:function(t){var n=t.text;return a("div",{},[e._v(e._s(e.gameState[n]))])}},{key:"action",fn:function(t){var n=t.text,r=t.record;return a("div",{},[a("a-button",{attrs:{type:"primary",size:"small",disabled:3!=r.state},on:{click:function(t){return e.handleEdit(r,n)}}},[e._v(" 结算 ")]),a("a-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"small",disabled:!(1==r.pass_lock&&1==r.state)},on:{click:function(t){return e.handleAudit(r,n)}}},[e._v(" 审核 ")])],1)}}])})],1),a("a-modal",{attrs:{title:"edit",visible:e.editShow,okText:"ok",cancelText:"cancel",width:620},on:{ok:e.handleConfirm,cancel:function(t){e.editShow=!1}}},[a("a-form-model",{attrs:{hideRequiredMark:""}},e._l(e.activeList.detail,(function(t,n){return a("div",[a("h3",[e._v(e._s(t.game_type))]),a("a-table",{attrs:{scroll:{y:300},pagination:!1,columns:e.columns,"data-source":t.detail},scopedSlots:e._u([{key:"modulo",fn:function(t,r,s){return a("span",{},[a("a-checkbox",{on:{change:function(a){return e.changeWin(r,t,n,s)}}})],1)}}],null,!0)})],1)})),0)],1),a("a-modal",{attrs:{title:"警告"},on:{ok:e.handleOk},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("h2",[e._v("请确认选择的选项，一旦结算无法更改!")]),e._l(e.confirm,(function(t){return a("h3",{staticStyle:{color:"#f00"}},[e._v(e._s(t))])}))],2)],1)},r=[],s=(a("a15b"),a("d81d"),a("b0c0"),a("3835")),c=(a("96cf"),a("1da1")),i=a("a078"),o=a("89cb"),l=a("a567"),u=a("f523"),d=a("ad8f"),g=(a("ed08"),[{title:"投注名",align:"center",dataIndex:"bet_name",key:"bet_name"},{title:"倍率",align:"center",dataIndex:"odds",key:"odds"},{title:"赢家",align:"center",dataIndex:"modulo",key:"modulo",scopedSlots:{customRender:"modulo"}}]),f={name:"game",components:{standardTable:l["a"],sku:u["a"]},data:function(){return{visible:!1,count:5,columns:g,value:"newsType",gameState:["可开始","审核中","游戏中","待结算"],currentAccount:"",activeList:{detail:[],game:null},confirm:[],treeData:[{title:"newsType",value:"newsType",key:"1",children:[{title:"football",value:"football",key:"2",children:[{title:"football1",value:"football1",key:"3"},{title:"football12",value:"football12",key:"4"}]},{title:"game",value:"game",key:"5",children:[{key:"6",title:"lol",value:"lol"}]}]}],typeOption:[{key:"football",label:"football"},{key:"game",label:"game"}],tableHead:[{title:"标题",align:"center",dataIndex:"title.subtitle",ellipsis:!0},{title:"游戏名",align:"center",dataIndex:"game_name"},{title:"结束时间",align:"center",dataIndex:"end_time",scopedSlots:{customRender:"end_time"}},{title:"是否通过",align:"center",dataIndex:"is_auto_pass",scopedSlots:{customRender:"is_auto_pass"}},{title:"是否显示",align:"center",dataIndex:"contract_is_show",scopedSlots:{customRender:"contract_is_show"}},{title:"是否锁定",align:"center",dataIndex:"pass_lock",scopedSlots:{customRender:"pass_lock"}},{title:"状态",align:"center",dataIndex:"state",scopedSlots:{customRender:"state"}},{title:"操作",align:"center",scopedSlots:{customRender:"action"},width:140}],tableData:[],loading:!1,selectedRowKeys:[],selectValue:[],currentEdit:{},editShow:!1,filterList:{name:"",status:"",page:1,size:15,total:0},deleteLoading:!1,exportLoading:!1}},mounted:function(){this.getAccounts(),this.getGameList({page:1,size:15})},methods:{getAccounts:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var a,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i["b"].eth.getAccounts();case 2:a=t.sent,n=Object(s["a"])(a,1),r=n[0],e.currentAccount=r;case 7:case"end":return t.stop()}}),t)})))()},getGameList:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loading=!0,a.prev=1,a.next=4,Object(o["h"])(e);case 4:n=a.sent,t.tableData=n.data.record,t.filterList.total=n.data.total||0,t.loading=!1,a.next=16;break;case 11:a.prev=11,a.t0=a["catch"](1),t.$message.error("系统繁忙"),t.loading=!1;case 16:case"end":return a.stop()}}),a,null,[[1,11]])})))()},getContractList:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(o["h"])(e);case 3:a.sent,a.next=11;break;case 7:a.prev=7,a.t0=a["catch"](0),t.$message.error("系统繁忙");case 11:case"end":return a.stop()}}),a,null,[[0,7]])})))()},settlementList:function(e,t,a){var n=this;return Object(c["a"])(regeneratorRuntime.mark((function r(){var s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=2,n.activeList={detail:[],game:null},r.next=6,Object(o["l"])({contract_address:e,game_id:t});case 6:s=r.sent,n.activeList.detail=s.data,n.activeList.game=e,n.activeList.title=a,n.editShow=!0,r.next=17;break;case 13:r.prev=13,r.t0=r["catch"](2),n.$message.error("系统繁忙");case 17:case"end":return r.stop()}}),r,null,[[2,13]])})))()},auditPass:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=1,a.next=4,Object(i["a"])(e);case 4:return n=a.sent,a.next=7,n.methods.pass(2e7,20000001).send({from:t.currentAccount,gas:"5000000"});case 7:r=a.sent,r.status&&(t.$message.error("结算成功"),t.getGameList({page:1,size:15})),a.next=15;break;case 11:a.prev=11,a.t0=a["catch"](1),t.$message.error("结算成功");case 15:case"end":return a.stop()}}),a,null,[[1,11]])})))()},timestampToTime:function(e,t){var a=new Date(1e3*e),n=a.getFullYear()+"-",r=(a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1)+"-",s=(a.getDate()<10?"0"+a.getDate():a.getDate())+" ",c=(a.getHours()<10?"0"+a.getHours():a.getHours())+":",i=(a.getMinutes()<10?"0"+a.getMinutes():a.getMinutes())+":",o=a.getSeconds()<10?"0"+a.getSeconds():a.getSeconds();return t?n+r+s+c+i+o:n+r+s},handleSelect:function(e,t){this.selectedRowKeys=e,this.selectValue=t},createArray:function(e){for(var t=[],a=0;a<e;a++)t[a]=!1;return t},getMaxModulo:function(e){return Object(c["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(i["a"])(e);case 2:return a=t.sent,t.next=6,a.methods.maxModulo().call();case 6:return n=t.sent,t.abrupt("return",n);case 8:case"end":return t.stop()}}),t)})))()},getFromData:function(){},getTableData:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var a,n,r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.filterList,a.name,a.status,n=a.page,r=a.size,e.loading=!0,t.prev=2,t.next=5,Object(o["h"])({page:n,size:r});case 5:s=t.sent,e.tableData=s.data.record,e.filterList.total=s.data.total||0,e.loading=!1,t.next=17;break;case 12:t.prev=12,t.t0=t["catch"](2),e.$message.error("系统繁忙"),e.loading=!1;case 17:case"end":return t.stop()}}),t,null,[[2,12]])})))()},changeStatus:function(e,t,a){var n=this;return Object(c["a"])(regeneratorRuntime.mark((function r(){var s,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return s={contract_address:e.contract_address},s[t+""]=a?1:0,r.prev=4,r.next=7,Object(o["m"])(s);case 7:c=r.sent,200==c.code&&(n.$message.success(c.message),e[t]=a),r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](4),n.$message.error("系统繁忙");case 15:case"end":return r.stop()}}),r,null,[[4,11]])})))()},changeWin:function(e,t,a,n){1==e["check"]?e["check"]=0:e["check"]=1},handleChangeCurrent:function(e){this.filterList.page=e,this.getTableData()},search:function(){this.filterList.page=1,this.getTableData()},handleEdit:function(e,t){var a=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n,r,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a.getAccounts(),t.next=3,i["b"].eth.getAccounts();case 3:if(n=t.sent,r=Object(s["a"])(n,1),c=r[0],a.currentAccount=c,a.currentAccount){t.next=10;break}return a.$message.error("请先登录MetaMask"),t.abrupt("return");case 10:a.settlementList(e.contract_address,e.game_id,e.title);case 12:case"end":return t.stop()}}),t)})))()},handleAudit:function(e,t){var a=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n,r,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i["b"].eth.getAccounts();case 2:if(n=t.sent,r=Object(s["a"])(n,1),c=r[0],a.currentAccount=c,a.currentAccount){t.next=9;break}return a.$message.error("请先登录MetaMask"),t.abrupt("return");case 9:a.auditPass(e.contract_address);case 11:case"end":return t.stop()}}),t)})))()},handleDelete:function(e){var t=this,a=e.id;Object(d["b"])({id:a}).then((function(e){t.getTableData(),t.$message.success("删除成功")}))},batchDeleteTable:function(){var e=this;if(0!=this.selectValue.length){this.deleteLoading=!0;var t=this.selectValue.map((function(e){return e.id})).join(",");Object(d["a"])({batchId:t}).then((function(t){e.getTableData(),e.$message.success("批量删除成功"),e.deleteLoading=!1}))}else this.$message.warning("请至少勾选一项")},handleOk:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var a,n,r,s,c,o,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=1,t.next=4,Object(i["a"])(e.activeList.game);case 4:return a=t.sent,t.next=7,a.methods.maxModulo().call();case 7:for(n=t.sent,r=e.createArray(n),s=e.activeList.detail,c=0;c<s.length;c++)for(o=0;o<s[c].detail.length;o++)1==s[c].detail[o].check&&(r[+s[c].detail[o].modulo-1]=!0);return t.next=15,a.methods.settleRound(r).send({from:e.currentAccount,gas:"5000000"});case 15:l=t.sent,l.status&&(e.$message.error("结算成功"),e.getGameList({page:1,size:15})),e.visible=!1,t.next=25;break;case 20:t.prev=20,t.t0=t["catch"](1),e.$message.error("系统繁忙"),e.visible=!1;case 25:case"end":return t.stop()}}),t,null,[[1,20]])})))()},handleConfirm:function(){var e=this.activeList.detail,t=!0;this.confirm=[];for(var a=0;a<e.length;a++)for(var n=0;n<e[a].detail.length;n++)1==e[a].detail[n].check&&(t=!1,this.confirm.push(e[a].detail[n].bet_name));t?this.$message.error("必须至少选择一项"):this.visible=!0}}},h=f,m=(a("7c91"),a("2877")),p=Object(m["a"])(h,n,r,!1,null,"665701a9",null);t["default"]=p.exports},a15b:function(e,t,a){"use strict";var n=a("23e7"),r=a("44ad"),s=a("fc6a"),c=a("a640"),i=[].join,o=r!=Object,l=c("join",",");n({target:"Array",proto:!0,forced:o||!l},{join:function(e){return i.call(s(this),void 0===e?",":e)}})},a567:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tableCommon-wrapper"},[a("a-table",{attrs:{columns:e.tableHead,dataSource:e.tableData,loading:e.loading,pagination:e.pagination,"row-selection":e.rowSelection,rowKey:"id",scroll:e.scroll},on:{change:e.handleTableChange},scopedSlots:e._u([e._l(Object.keys(e.$scopedSlots).filter((function(e){return"expandedRowRender"!==e})),(function(t){return{key:t,fn:function(a,n,r){return[e._t(t,null,null,{text:a,record:n,index:r})]}}}))],null,!0)})],1)},r=[],s={name:"standardTable",props:{tableHead:{type:Array,required:!0},tableData:{type:Array,required:!0},loading:{type:Boolean,default:!1},pagination:{type:Boolean|Object},rowSelection:{type:Object},scroll:{type:Object}},data:function(){return{}},methods:{handleTableChange:function(e){this.$emit("changeCurrent",e.current)}}},c=s,i=a("2877"),o=Object(i["a"])(c,n,r,!1,null,"efa95cdc",null);t["a"]=o.exports},ad8f:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return c}));var n=a("b775"),r=n.request;function s(e){return r.post("/table/deleteTable",e)}function c(e){return r.post("/table/batchDeleteTable",e)}},ebf0:function(e,t,a){},ed08:function(e,t,a){"use strict";function n(e,t){var a,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this;return function(){for(var s=arguments.length,c=new Array(s),i=0;i<s;i++)c[i]=arguments[i];if(n)return e.apply(r,c),void(n=!1);clearTimeout(a),a=setTimeout((function(){e.apply(r,c)}),t)}}a.d(t,"a",(function(){return n}))}}]);